import{a as o,j as t,o as n,U as a,r as u,b as d}from"./index-C8JFuZlv.js";import{P as x,B as m}from"./index-DR008vrG.js";import{E as p}from"./index-Bz5g5oRx.js";import{p as g,q as l,r as h}from"./useMetadata-D7nd75QV.js";import{f}from"./dateUtils-Br-z8UuZ.js";import"./useMutation-B4GGscfX.js";const E=e=>{switch(e){case"REVIEW":return"리뷰";case"COMMENT":return"댓글";case"LIKE":return"좋아요";case"SYSTEM":return"시스템";case"NOTICE":return"공지사항";default:return"알림"}},N=e=>{switch(e){case"REVIEW":return"⭐";case"COMMENT":return"💬";case"LIKE":return"❤️";case"SYSTEM":return"⚙️";case"NOTICE":return"📢";default:return"🔔"}},j=(e,s)=>{if(!s)return null;switch(e){case"COMMENT":case"LIKE":return a.COMMUNITY_POST.replace(":id",s.toString());case"REVIEW":return a.SCHOOL_DETAIL.replace(":id",s.toString())+"?tab=review";case"NOTICE":return a.NOTICE_DETAIL.replace(":id",s.toString());case"SYSTEM":return a.USER_ACCOUNT_SETTING;default:return null}};function b({alarm:e}){const{mutate:s}=g(),r=o(),c=()=>{e.isRead||s(e.id);const i=j(e.type,e.targetId);i&&r(i)};return t.jsx("li",{className:n("flex flex-col gap-2 p-4 border-b border-primary-light02 transition-colors cursor-pointer",e.isRead?"hover:bg-gray-50":"bg-blue-50 hover:bg-blue-100"),onClick:c,children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"flex-shrink-0 text-lg",children:N(e.type)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:n("text-xs px-2 py-1 rounded-full",e.isRead?"bg-gray-100 text-gray-600":"bg-blue-100 text-blue-700"),children:E(e.type)}),!e.isRead&&t.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.groupCount&&e.groupCount>1&&t.jsxs("span",{className:"text-xs px-2 py-1 bg-gray-200 text-gray-700 rounded-full",children:["+",e.groupCount-1]})]}),t.jsx("h3",{className:n("font-medium text-sm line-clamp-1 mb-1",e.isRead?"text-primary-dark01":"text-primary-dark02"),children:e.title}),t.jsx("p",{className:n("text-sm line-clamp-2 whitespace-pre-line",e.isRead?"text-primary-normal03":"text-primary-dark01"),children:e.message}),t.jsx("span",{className:"text-primary-normal03 text-xs mt-2",children:f(e.createdAt)})]})]})})}function y(){const{data:e}=l();return!(e!=null&&e.data)||e.data.length===0?t.jsx(p,{title:"아직 받은 알림이 없습니다",subTitle:"활동하시면 알림을 받을 수 있어요!"}):t.jsx("ul",{className:"flex flex-col",children:e.data.map(s=>t.jsx(b,{alarm:s},s.id))})}function O(){const{mutate:e,isPending:s}=h(),r=()=>{e()};return t.jsx(x,{title:"원바원 | 알림함",description:"알림 목록",headerTitle:"알림함",currentPath:a.USER,hasBackButton:!0,wrapperBg:"white",mainClassName:"mt-14",children:t.jsx(u.Suspense,{fallback:t.jsx(d,{}),children:t.jsx(T,{handleReadAll:r,isPending:s})})})}function T({handleReadAll:e,isPending:s}){const{hasUnreadAlarms:r}=l();return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex items-center justify-end p-4",children:t.jsx(m,{variant:"transparent",size:"sm",onClick:e,disabled:s||!r,className:`text-sm ${r?"text-primary-normal01":"cursor-not-allowed text-gray-400"}`,children:s?"처리중...":"모두 읽음"})}),t.jsx(y,{})]})}export{O as default};
