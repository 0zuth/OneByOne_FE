import{u as y}from"./useMetadata-D7nd75QV.js";import{u as C}from"./useSuspenseInfiniteQuery-BdZRK4nz.js";import{C as n,D as u,x as i,E as o}from"./index-C8JFuZlv.js";import{u as c}from"./useMutation-B4GGscfX.js";import{D as l,a as d,R as E}from"./query-config-BQJB0S96.js";const P=async()=>n({method:"GET",path:u.COMMUNITY.POST.TOP}),h=async t=>{var e,s;const r=new URLSearchParams;return r.append("page",((e=t.page)==null?void 0:e.toString())||"0"),r.append("size",((s=t.size)==null?void 0:s.toString())||"10"),r.append("category",t.category||"TEACHER"),t.categoryName&&t.categoryName.trim()!==""&&r.append("categoryName",t.categoryName),t.title&&t.title.trim()!==""&&r.append("title",t.title),t.content&&t.content.trim()!==""&&r.append("content",t.content),t.userName&&t.userName.trim()!==""&&r.append("userName",t.userName),n({method:"GET",path:`${u.COMMUNITY.BASE}?${r.toString()}`})},T=async t=>n({method:"GET",path:u.COMMUNITY.POST.DETAIL(t)}),g=async t=>n({method:"POST",path:u.COMMUNITY.BASE,data:t,withAuth:!0}),N=async t=>n({method:"GET",path:u.COMMUNITY.POST.LIKE(t),withAuth:!0}),M=async t=>{const r={postId:t};return n({method:"POST",path:u.COMMUNITY.POST.LIKE(t),data:r,withAuth:!0})},S=async t=>{var e,s;const r=new URLSearchParams({page:((e=t.page)==null?void 0:e.toString())||"0",size:((s=t.size)==null?void 0:s.toString())||"10",...t.sort&&{sort:t.sort.join(",")}}).toString();return n({method:"GET",path:`${u.COMMUNITY.COMMENT.ALL(t.postId)}?${r}`})},O=async t=>{const{postId:r,...e}=t;return n({method:"POST",path:u.COMMUNITY.COMMENT.BASE(r),data:e,withAuth:!0})},q=async t=>n({method:"DELETE",path:u.COMMUNITY.POST.DELETE(t),withAuth:!0}),I=async t=>n({method:"DELETE",path:u.COMMUNITY.COMMENT.DELETE(t),withAuth:!0}),K=()=>y({queryKey:["popularPosts"],queryFn:P,...l}),F=(t=10,r,e)=>{const s=["communityPosts",r,t.toString(),(e==null?void 0:e.categoryName)||"all",(e==null?void 0:e.title)||"",(e==null?void 0:e.content)||"",(e==null?void 0:e.userName)||""];return C({queryKey:s,queryFn:({pageParam:a=0})=>h({page:a,size:t,category:r,...e}),getNextPageParam:a=>{if(!(!a.content||a.content.length===0)&&!a.last)return a.pageNumber+1},initialPageParam:0,...l})},U=t=>y({queryKey:["communityPost",t],queryFn:()=>T(t),enabled:!!t,...d}),Y=()=>{const t=i();return c({mutationFn:g,onSuccess:()=>{t.invalidateQueries({queryKey:["communityPosts"]}),t.invalidateQueries({queryKey:["popularPosts"]}),o({title:"게시글이 등록되었습니다.",variant:"default"})},onError:()=>{o({title:"게시글 등록에 실패했습니다.",variant:"destructive"})}})},p=()=>c({mutationFn:t=>M(t),onError:()=>{o({title:"좋아요 오류",variant:"destructive"})}}),Q=t=>y({queryKey:["likeStatus",t],queryFn:()=>N(t),enabled:!!t,...E}),_=t=>{const r=i(),e=0;return{...C({queryKey:["comments",t.postId],queryFn:({pageParam:m=e})=>S({...t,page:m}),getNextPageParam:m=>m.last?void 0:m.pageNumber+1,initialPageParam:e,...l}),refetchComments:()=>r.invalidateQueries({queryKey:["comments",t.postId]})}},w=()=>{const t=i();return c({mutationFn:O,onSuccess:(r,e)=>{t.invalidateQueries({queryKey:["comments",e.postId]})},onError:()=>{o({title:"댓글 작성에 실패했습니다.",variant:"destructive"})}})},G=()=>{const t=i();return c({mutationFn:q,onSuccess:()=>{t.invalidateQueries({queryKey:["communityPosts"]}),t.invalidateQueries({queryKey:["popularPosts"]}),o({title:"게시글이 삭제되었습니다.",variant:"default"})},onError:()=>{o({title:"게시글 삭제에 실패했습니다.",variant:"destructive"})}})},b=()=>{const t=i();return c({mutationFn:({commentId:r})=>I(r),onSuccess:(r,e)=>{t.invalidateQueries({queryKey:["comments",e.postId]})},onError:()=>{o({title:"댓글 삭제에 실패했습니다.",variant:"destructive"})}})};export{F as a,_ as b,U as c,Q as d,w as e,p as f,G as g,b as h,Y as i,K as u};
