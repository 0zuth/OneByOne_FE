import{R as h,j as S,o as R,B as f,C as c,D as l,x as E,u as g}from"./index-C8JFuZlv.js";import{b as p}from"./useMetadata-D7nd75QV.js";import{u as y}from"./useMutation-B4GGscfX.js";import{R as d}from"./review-IuptfKQ8.js";const k=f("cursor-pointer transition-colors",{variants:{size:{xs:"w-2 h-2",sm:"w-6 h-6",md:"w-8 h-8",lg:"w-10 h-10"},selected:{true:"bg-tertiary-2",false:"bg-primary-light02"}},defaultVariants:{size:"md",selected:!1}}),w=h.memo(({className:t,value:r,size:s,isSelected:a=!1,onClick:o,...u})=>S.jsx("div",{className:R(k({size:s,selected:a,className:t})),onClick:o,"aria-selected":a,role:"button",tabIndex:0,"data-value":r,...u})),K=h.memo(({value:t,onChange:r,max:s=5,size:a="md",className:o,...u})=>{const m=h.useCallback(i=>{r==null||r(i)},[r]);return S.jsx("div",{className:R("flex gap-2",o),...u,children:Array.from({length:s},(i,e)=>e+1).map(i=>S.jsx(w,{value:i,size:a,isSelected:i<=t,onClick:()=>m(i)},i))})}),I=async(t,r)=>{const s=r?`?sortType=${r}`:"";return c({method:"GET",path:l.WORK.GET_ALL(t)+s,withAuth:!0})},v=async(t,r)=>{const s=r?`?sortType=${r}`:"";return c({method:"GET",path:l.INTERNSHIP.GET_ALL(t)+s,withAuth:!0})},b=async t=>c({method:"POST",path:l.INTERNSHIP.BASE,data:t,withAuth:!0}),A=async t=>c({method:"POST",path:l.WORK.BASE,data:t,withAuth:!0}),W=async t=>c({method:"POST",path:l.WORK.LIKE(t),withAuth:!0}),q=async t=>c({method:"POST",path:l.INTERNSHIP.LIKE(t),withAuth:!0}),O={reviews:[],rating:{total:0},scores:{}};function L(t,r,s){const{data:a}=p({queryKey:["workReviews",t,s],queryFn:()=>I(Number(t),s)}),{data:o}=p({queryKey:["internshipReviews",t,s],queryFn:()=>v(Number(t),s)});if(!a&&!o)return O;const u=r===d.WORK?(a==null?void 0:a.content)||[]:(o==null?void 0:o.content)||[],m=u.reduce((e,n)=>r===d.WORK&&"workReviewId"in n?e+(n.benefitAndSalaryScore+n.workLifeBalanceScore+n.workEnvironmentScore+n.managerScore+n.customerScore)/5:"internshipReviewId"in n?e+(n.workEnvironmentScore+n.learningSupportScore+n.instructionTeacherScore)/3:e,0)/u.length||0,i=u.reduce((e,n)=>(r===d.WORK&&"workReviewId"in n?(e.welfare=(e.welfare||0)+n.benefitAndSalaryScore,e.workLabel=(e.workLabel||0)+n.workLifeBalanceScore,e.atmosphere=(e.atmosphere||0)+n.workEnvironmentScore,e.manager=(e.manager||0)+n.managerScore,e.customer=(e.customer||0)+n.customerScore):"internshipReviewId"in n&&(e.atmosphere=(e.atmosphere||0)+n.workEnvironmentScore,e.studyHelp=(e.studyHelp||0)+n.learningSupportScore,e.teacherGuide=(e.teacherGuide||0)+n.instructionTeacherScore),e),{});return Object.keys(i).forEach(e=>{i[e]=i[e]/u.length||0}),{reviews:u,rating:{total:m},scores:i}}const _=()=>{const t=E(),{toast:r}=g();return y({mutationFn:b,onSuccess:(s,a)=>{t.invalidateQueries({queryKey:["internshipReviews",a.kindergartenId.toString()]}),r({title:"실습 리뷰 작성 완료",description:"게시된 리뷰를 확인해보세요. 🧐",variant:"default"})},onError:s=>{const a=(()=>{var o;try{return(o=JSON.parse(s.message).data)==null?void 0:o.message}catch{return s.message}})()||"잠시 후 다시 시도해주세요.";r({title:"실습 리뷰 등록 실패",description:a,variant:"destructive"}),console.error("실습 리뷰 생성 에러:",s)}})},B=()=>{const t=E(),{toast:r}=g();return y({mutationFn:A,onSuccess:(s,a)=>{t.invalidateQueries({queryKey:["workReviews",a.kindergartenId.toString()]}),r({title:"근무 리뷰 작성 완료",description:"게시된 리뷰를 확인해보세요. 🧐",variant:"default"})},onError:s=>{const a=(()=>{var o;try{return(o=JSON.parse(s.message).data)==null?void 0:o.message}catch{return s.message}})()||"잠시 후 다시 시도해주세요.";r({title:"근무 리뷰 등록 실패",description:a,variant:"destructive"}),console.error("근무 리뷰 생성 에러:",s)}})};export{K as B,q as a,B as b,_ as c,W as l,L as u};
